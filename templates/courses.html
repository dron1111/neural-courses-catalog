{% extends "base.html" %}

{% block title %}–ö–∞—Ç–∞–ª–æ–≥ –∫—É—Ä—Å–æ–≤{% endblock %}

{% block content %}
<div class="container">
    <h1>–ö–∞—Ç–∞–ª–æ–≥ –∫—É—Ä—Å–æ–≤</h1>
    
    <div class="filter-panel">
        <form method="get" action="/courses">
            <div class="search-box">
                <input type="text" name="query" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é, —Ç–µ–≥–∞–º..." value="{{ current_query or '' }}">
                <button type="submit">–ü–æ–∏—Å–∫</button>
            </div>
            
            <div class="filters">
                <select name="category">
                    <option value="all">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                    {% for cat in available_categories %}
                    <option value="{{ cat }}" {% if current_category == cat %}selected{% endif %}>
                        {{ cat }}
                    </option>
                    {% endfor %}
                </select>
                
                <select name="level">
                    <option value="all">–í—Å–µ —É—Ä–æ–≤–Ω–∏</option>
                    <option value="beginner" {% if current_level == 'beginner' %}selected{% endif %}>–ù–∞—á–∏–Ω–∞—é—â–∏–π</option>
                    <option value="middle" {% if current_level == 'middle' %}selected{% endif %}>–°—Ä–µ–¥–Ω–∏–π</option>
                    <option value="pro" {% if current_level == 'pro' %}selected{% endif %}>–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª</option>
                </select>
                
                <select name="format">
                    <option value="all">–í—Å–µ —Ñ–æ—Ä–º–∞—Ç—ã</option>
                    <option value="online" {% if current_format == 'online' %}selected{% endif %}>–û–Ω–ª–∞–π–Ω</option>
                    <option value="offline" {% if current_format == 'offline' %}selected{% endif %}>–û—Ñ–ª–∞–π–Ω</option>
                    <option value="mixed" {% if current_format == 'mixed' %}selected{% endif %}>–°–º–µ—à–∞–Ω–Ω—ã–π</option>
                </select>
                
                <input type="number" name="price_min" placeholder="–¶–µ–Ω–∞ –æ—Ç" value="{{ current_price_min or '' }}">
                <input type="number" name="price_max" placeholder="–¶–µ–Ω–∞ –¥–æ" value="{{ current_price_max or '' }}">
                
                <select name="sort">
                    <option value="popular" {% if current_sort == 'popular' %}selected{% endif %}>–ü–æ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏</option>
                    <option value="new" {% if current_sort == 'new' %}selected{% endif %}>–ù–æ–≤—ã–µ</option>
                    <option value="price_asc" {% if current_sort == 'price_asc' %}selected{% endif %}>–î–µ—à–µ–≤–ª–µ</option>
                    <option value="price_desc" {% if current_sort == 'price_desc' %}selected{% endif %}>–î–æ—Ä–æ–∂–µ</option>
                </select>
                
                <button type="submit">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
                <a href="/courses" class="btn">–°–±—Ä–æ—Å–∏—Ç—å</a>
            </div>
        </form>
    </div>
    
    <p>–ù–∞–π–¥–µ–Ω–æ –∫—É—Ä—Å–æ–≤: {{ total_courses }}</p>
    
    <div class="courses-grid">
        {% for course in courses %}
        <div class="course-card">
            <h3><a href="/course/{{ course.slug }}">{{ course.title }}</a></h3>
            <p class="provider">{{ course.provider }}</p>
            <p class="price">–æ—Ç {{ course.price_from }} ‚ÇΩ</p>
            <p class="level">{{ course.level }}</p>
            <p class="category">{{ course.category_slug }}</p>
            <p class="clicks">üëÅ {{ course.clicks }} –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤</p>
            <a href="/course/{{ course.slug }}" class="btn">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
        </div>
        {% endfor %}
    </div>
    
    {% if total_pages > 1 %}
    <div class="pagination">
        {% if current_page > 1 %}
        <a href="?page={{ current_page-1 }}&query={{ current_query }}&category={{ current_category }}&level={{ current_level }}&format={{ current_format }}&price_min={{ current_price_min }}&price_max={{ current_price_max }}&sort={{ current_sort }}">‚Üê</a>
        {% endif %}
        
        <span>–°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ current_page }} –∏–∑ {{ total_pages }}</span>
        
        {% if current_page < total_pages %}
        <a href="?page={{ current_page+1 }}&query={{ current_query }}&category={{ current_category }}&level={{ current_level }}&format={{ current_format }}&price_min={{ current_price_min }}&price_max={{ current_price_max }}&sort={{ current_sort }}">‚Üí</a>
        {% endif %}
    </div>
    {% endif %}
</div>
{% endblock %}
