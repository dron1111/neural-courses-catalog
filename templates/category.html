{% extends "base.html" %}

{% block title %}–ö—É—Ä—Å—ã –ø–æ —Ç–µ–º–µ ¬´{{ category_name }}¬ª ‚Äî –ö–∞—Ç–∞–ª–æ–≥ –∫—É—Ä—Å–æ–≤ –ø–æ –Ω–µ–π—Ä–æ—Å–µ—Ç—è–º{% endblock %}
{% block description %}–í—Å–µ –∫—É—Ä—Å—ã –ø–æ —Ç–µ–º–µ ¬´{{ category_name }}¬ª. –§–∏–ª—å—Ç—Ä—ã –ø–æ —É—Ä–æ–≤–Ω—é, —Ñ–æ—Ä–º–∞—Ç—É –∏ —Ü–µ–Ω–µ.{% endblock %}

{% block content %}
<div class="mb-8">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
    <div class="mb-8">
        <h1 class="text-3xl font-bold mb-2">–ö–∞—Ç–µ–≥–æ—Ä–∏—è: {{ category_name }}</h1>
        <p class="text-gray-600">–ù–∞–π–¥–µ–Ω–æ –∫—É—Ä—Å–æ–≤: <strong>{{ total_courses }}</strong></p>
    </div>

    <!-- –ü—Ä–æ—Å—Ç—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã -->
    <div class="bg-white p-6 rounded-xl shadow-lg mb-8">
        <form method="get" class="space-y-4 md:space-y-0 md:grid md:grid-cols-4 md:gap-4">
            <!-- –£—Ä–æ–≤–µ–Ω—å -->
            <select name="level" class="w-full border border-gray-300 rounded-lg p-3">
                <option value="all">–í—Å–µ —É—Ä–æ–≤–Ω–∏</option>
                <option value="beginner" {% if current_level == 'beginner' %}selected{% endif %}>–ù–∞—á–∏–Ω–∞—é—â–∏–π</option>
                <option value="middle" {% if current_level == 'middle' %}selected{% endif %}>–°—Ä–µ–¥–Ω–∏–π</option>
                <option value="pro" {% if current_level == 'pro' %}selected{% endif %}>–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª</option>
            </select>
            
            <!-- –§–æ—Ä–º–∞—Ç -->
            <select name="format" class="w-full border border-gray-300 rounded-lg p-3">
                <option value="all">–í—Å–µ —Ñ–æ—Ä–º–∞—Ç—ã</option>
                <option value="online" {% if current_format == 'online' %}selected{% endif %}>–û–Ω–ª–∞–π–Ω</option>
                <option value="offline" {% if current_format == 'offline' %}selected{% endif %}>–û—Ñ–ª–∞–π–Ω</option>
                <option value="mixed" {% if current_format == 'mixed' %}selected{% endif %}>–°–º–µ—à–∞–Ω–Ω—ã–π</option>
            </select>
            
            <!-- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ -->
            <select name="sort" class="w-full border border-gray-300 rounded-lg p-3">
                <option value="popular" {% if current_sort == 'popular' %}selected{% endif %}>–ü–æ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏</option>
                <option value="new" {% if current_sort == 'new' %}selected{% endif %}>–°–Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã–µ</option>
                <option value="price_asc" {% if current_sort == 'price_asc' %}selected{% endif %}>–°–Ω–∞—á–∞–ª–∞ –¥–µ—à–µ–≤–ª–µ</option>
                <option value="price_desc" {% if current_sort == 'price_desc' %}selected{% endif %}>–°–Ω–∞—á–∞–ª–∞ –¥–æ—Ä–æ–∂–µ</option>
            </select>
            
            <div class="space-x-2">
                <button type="submit" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 font-medium w-full md:w-auto">
                    –ü—Ä–∏–º–µ–Ω–∏—Ç—å
                </button>
                <a href="/category/{{ category_slug }}" class="inline-block border border-gray-300 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-50 font-medium text-center w-full md:w-auto">
                    –°–±—Ä–æ—Å–∏—Ç—å
                </a>
            </div>
        </form>
        
        <!-- –ü–æ–∏—Å–∫ –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
        <div class="mt-4">
            <form method="get" class="flex">
                <input type="text" name="query" value="{{ current_query or '' }}" 
                       placeholder="–ü–æ–∏—Å–∫ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ {{ category_name }}..." 
                       class="flex-grow border border-gray-300 rounded-l-lg p-3">
                <button type="submit" class="bg-gray-800 text-white px-6 py-3 rounded-r-lg hover:bg-gray-900">
                    –ù–∞–π—Ç–∏
                </button>
            </form>
        </div>
    </div>

    <!-- –°–ø–∏—Å–æ–∫ –∫—É—Ä—Å–æ–≤ -->
    {% if courses %}
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
        {% for course in courses %}
        <div class="bg-white rounded-xl shadow-md overflow-hidden hover:shadow-xl transition-shadow duration-300">
            <div class="p-6">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <span class="inline-block bg-blue-100 text-blue-800 text-xs font-semibold px-3 py-1 rounded-full">{{ course.category_slug }}</span>
                        <span class="inline-block bg-gray-100 text-gray-800 text-xs font-semibold px-3 py-1 rounded-full ml-2">{{ course.level }}</span>
                    </div>
                    <span class="text-2xl font-bold text-blue-600">{{ course.price_from }} ‚ÇΩ</span>
                </div>
                
                <h3 class="text-xl font-bold mb-3">{{ course.title }}</h3>
                <p class="text-gray-600 mb-4">{{ course.short_desc|truncate(100) }}</p>
                
                <div class="flex justify-between items-center mt-4">
                    <span class="text-gray-500">{{ course.duration }}</span>
                    <a href="/course/{{ course.slug }}" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 font-medium">
                        –ü–æ–¥—Ä–æ–±–Ω–µ–µ ‚Üí
                    </a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="text-center py-12">
        <div class="text-gray-400 text-6xl mb-4">üîç</div>
        <h3 class="text-xl font-semibold text-gray-700 mb-2">–ö—É—Ä—Å—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
        <p class="text-gray-500 mb-6">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏</p>
        <a href="/category/{{ category_slug }}" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 font-medium">
            –°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
        </a>
    </div>
    {% endif %}

    <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
    {% if total_pages > 1 %}
    <div class="flex justify-center items-center space-x-2">
        {% if current_page > 1 %}
        <a href="?page={{ current_page - 1 }}{% if current_level %}&level={{ current_level }}{% endif %}{% if current_format %}&format={{ current_format }}{% endif %}{% if current_sort %}&sort={{ current_sort }}{% endif %}" 
           class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">
            ‚Üê –ù–∞–∑–∞–¥
        </a>
        {% endif %}
        
        <span class="px-4 py-2 text-gray-700">
            –°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ current_page }} –∏–∑ {{ total_pages }}
        </span>
        
        {% if current_page < total_pages %}
        <a href="?page={{ current_page + 1 }}{% if current_level %}&level={{ current_level }}{% endif %}{% if current_format %}&format={{ current_format }}{% endif %}{% if current_sort %}&sort={{ current_sort }}{% endif %}" 
           class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">
            –î–∞–ª–µ–µ ‚Üí
        </a>
        {% endif %}
    </div>
    {% endif %}
</div>
{% endblock %}
