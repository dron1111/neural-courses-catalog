{% extends "base.html" %}

{% block title %}–ö–∞—Ç–∞–ª–æ–≥ –∫—É—Ä—Å–æ–≤ –ø–æ –Ω–µ–π—Ä–æ—Å–µ—Ç—è–º{% endblock %}
{% block description %}–ù–∞–π–¥–∏—Ç–µ –ª—É—á—à–∏–µ –∫—É—Ä—Å—ã –ø–æ AI, –º–∞—à–∏–Ω–Ω–æ–º—É –æ–±—É—á–µ–Ω–∏—é –∏ –Ω–µ–π—Ä–æ—Å–µ—Ç—è–º. –§–∏–ª—å—Ç—Ä—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, —É—Ä–æ–≤–Ω—é, —Ñ–æ—Ä–º–∞—Ç—É –∏ —Ü–µ–Ω–µ.{% endblock %}

{% block content %}
<div class="mb-8">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
    <div class="mb-8">
        <h1 class="text-3xl font-bold mb-2">–ö–∞—Ç–∞–ª–æ–≥ –∫—É—Ä—Å–æ–≤ –ø–æ –Ω–µ–π—Ä–æ—Å–µ—Ç—è–º</h1>
        <p class="text-gray-600">–ù–∞–π–¥–µ–Ω–æ –∫—É—Ä—Å–æ–≤: <strong>{{ total_courses }}</strong></p>
    </div>

    <!-- –§–ò–õ–¨–¢–†–´ –ò –ü–û–ò–°–ö -->
    <div class="bg-white p-6 rounded-xl shadow-lg mb-8">
        <form method="get" class="space-y-6">
            <!-- –ü–æ–∏—Å–∫ -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é, —Ç–µ–≥–∞–º –∏–ª–∏ –æ–ø–∏—Å–∞–Ω–∏—é</label>
                <input type="text" name="query" value="{{ current_query or '' }}" 
                       placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: python, –¥–∏–∑–∞–π–Ω, –º–∞—Ä–∫–µ—Ç–∏–Ω–≥..." 
                       class="w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            </div>

            <!-- –§–∏–ª—å—Ç—Ä—ã –≤ —Å–µ—Ç–∫–µ -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏—è -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                    <select name="category" class="w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <option value="all">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                        {% for cat in available_categories %}
                        <option value="{{ cat }}" {% if current_category == cat %}selected{% endif %}>{{ cat }}</option>
                        {% endfor %}
                    </select>
                </div>

                <!-- –£—Ä–æ–≤–µ–Ω—å -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">–£—Ä–æ–≤–µ–Ω—å</label>
                    <select name="level" class="w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <option value="all">–í—Å–µ —É—Ä–æ–≤–Ω–∏</option>
                        <option value="beginner" {% if current_level == 'beginner' %}selected{% endif %}>–ù–∞—á–∏–Ω–∞—é—â–∏–π</option>
                        <option value="middle" {% if current_level == 'middle' %}selected{% endif %}>–°—Ä–µ–¥–Ω–∏–π</option>
                        <option value="pro" {% if current_level == 'pro' %}selected{% endif %}>–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª</option>
                    </select>
                </div>

                <!-- –§–æ—Ä–º–∞—Ç -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">–§–æ—Ä–º–∞—Ç</label>
                    <select name="format" class="w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <option value="all">–í—Å–µ —Ñ–æ—Ä–º–∞—Ç—ã</option>
                        <option value="online" {% if current_format == 'online' %}selected{% endif %}>–û–Ω–ª–∞–π–Ω</option>
                        <option value="offline" {% if current_format == 'offline' %}selected{% endif %}>–û—Ñ–ª–∞–π–Ω</option>
                        <option value="mixed" {% if current_format == 'mixed' %}selected{% endif %}>–°–º–µ—à–∞–Ω–Ω—ã–π</option>
                    </select>
                </div>

                <!-- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞</label>
                    <select name="sort" class="w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <option value="popular" {% if current_sort == 'popular' %}selected{% endif %}>–ü–æ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏</option>
                        <option value="new" {% if current_sort == 'new' %}selected{% endif %}>–°–Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã–µ</option>
                        <option value="price_asc" {% if current_sort == 'price_asc' %}selected{% endif %}>–°–Ω–∞—á–∞–ª–∞ –¥–µ—à–µ–≤–ª–µ</option>
                        <option value="price_desc" {% if current_sort == 'price_desc' %}selected{% endif %}>–°–Ω–∞—á–∞–ª–∞ –¥–æ—Ä–æ–∂–µ</option>
                    </select>
                </div>
            </div>

            <!-- –î–∏–∞–ø–∞–∑–æ–Ω —Ü–µ–Ω -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞</label>
                    <input type="number" name="price_min" value="{{ current_price_min or '' }}" 
                           min="0" max="{{ price_range.max }}" step="1000"
                           placeholder="–û—Ç 0"
                           class="w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞</label>
                    <input type="number" name="price_max" value="{{ current_price_max or '' }}" 
                           min="0" max="{{ price_range.max }}" step="1000"
                           placeholder="–î–æ {{ price_range.max }}"
                           class="w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                </div>
            </div>

            <!-- –ö–Ω–æ–ø–∫–∏ -->
            <div class="flex flex-wrap gap-4 pt-2">
                <button type="submit" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 font-medium flex items-center">
                    <span class="mr-2">üîç</span> –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
                </button>
                <a href="/courses" class="border border-gray-300 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-50 font-medium flex items-center">
                    <span class="mr-2">‚Ü∫</span> –°–±—Ä–æ—Å–∏—Ç—å –≤—Å—ë
                </a>
                <div class="ml-auto text-gray-500 text-sm">
                    –°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ current_page }} –∏–∑ {{ total_pages }}
                </div>
            </div>
        </form>
    </div>

    <!-- –°–ü–ò–°–û–ö –ö–£–†–°–û–í -->
    {% if courses %}
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
        {% for course in courses %}
        <div class="bg-white rounded-xl shadow-md overflow-hidden hover:shadow-xl transition-shadow duration-300">
            <div class="p-6">
                <!-- –ë–µ–π–¥–∂–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —É—Ä–æ–≤–Ω—è -->
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <span class="inline-block bg-blue-100 text-blue-800 text-xs font-semibold px-3 py-1 rounded-full">{{ course.category_slug }}</span>
                        <span class="inline-block bg-gray-100 text-gray-800 text-xs font-semibold px-3 py-1 rounded-full ml-2">{{ course.level }}</span>
                    </div>
                    <span class="text-2xl font-bold text-blue-600">{{ course.price_from }} ‚ÇΩ</span>
                </div>
                
                <!-- –ù–∞–∑–≤–∞–Ω–∏–µ –∫—É—Ä—Å–∞ -->
                <h3 class="text-xl font-bold mb-3 hover:text-blue-600">
                    <a href="/course/{{ course.slug }}">{{ course.title }}</a>
                </h3>
                
                <!-- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ -->
                <p class="text-gray-600 mb-4 line-clamp-2">{{ course.short_desc }}</p>
                
                <!-- –¢–µ–≥–∏ -->
                <div class="mb-4 flex flex-wrap gap-1">
                    {% for tag in (course.tags or '').split(',')[:3] %}
                    {% if tag %}
                    <span class="inline-block bg-gray-100 text-gray-600 text-xs px-2 py-1 rounded">{{ tag }}</span>
                    {% endif %}
                    {% endfor %}
                </div>
                
                <!-- –§—É—Ç–µ—Ä –∫–∞—Ä—Ç–æ—á–∫–∏ -->
                <div class="flex justify-between items-center pt-4 border-t border-gray-100">
                    <div class="text-gray-500 text-sm">
                        <span class="mr-3">üëÅ {{ course.clicks }} –∫–ª–∏–∫–æ–≤</span>
                        <span>{{ course.duration }}</span>
                    </div>
                    <a href="/course/{{ course.slug }}" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 font-medium">
                        –ü–æ–¥—Ä–æ–±–Ω–µ–µ ‚Üí
                    </a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <!-- –ï—Å–ª–∏ –∫—É—Ä—Å—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã -->
    <div class="text-center py-12">
        <div class="text-gray-400 text-6xl mb-4">üîç</div>
        <h3 class="text-xl font-semibold text-gray-700 mb-2">–ö—É—Ä—Å—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
        <p class="text-gray-500 mb-6">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞ –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä—ã</p>
        <a href="/courses" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 font-medium">
            –°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
        </a>
    </div>
    {% endif %}

    <!-- –ü–ê–ì–ò–ù–ê–¶–ò–Ø -->
    {% if total_pages > 1 %}
    <div class="flex justify-center items-center space-x-2 mt-8">
        {% if current_page > 1 %}
        <a href="?page={{ current_page - 1 }}{% if current_query %}&query={{ current_query }}{% endif %}{% if current_category %}&category={{ current_category }}{% endif %}{% if current_sort %}&sort={{ current_sort }}{% endif %}" 
           class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 font-medium">
            ‚Üê –ù–∞–∑–∞–¥
        </a>
        {% endif %}
        
        <div class="flex space-x-1">
            {% for p in range(1, total_pages + 1) %}
                {% if p == current_page %}
                <span class="px-4 py-2 bg-blue-600 text-white rounded-lg font-medium">{{ p }}</span>
                {% elif p >= current_page - 2 and p <= current_page + 2 %}
                <a href="?page={{ p }}{% if current_query %}&query={{ current_query }}{% endif %}{% if current_category %}&category={{ current_category }}{% endif %}{% if current_sort %}&sort={{ current_sort }}{% endif %}" 
                   class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">{{ p }}</a>
                {% endif %}
            {% endfor %}
        </div>
        
        {% if current_page < total_pages %}
        <a href="?page={{ current_page + 1 }}{% if current_query %}&query={{ current_query }}{% endif %}{% if current_category %}&category={{ current_category }}{% endif %}{% if current_sort %}&sort={{ current_sort }}{% endif %}" 
           class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 font-medium">
            –î–∞–ª–µ–µ ‚Üí
        </a>
        {% endif %}
    </div>
    {% endif %}
</div>
{% endblock %}
